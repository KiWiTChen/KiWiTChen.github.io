<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="ä»»åŠ¡ç›®æ ‡ åµŒâ¼Šå¼æ“ä½œç³»ç»Ÿæ˜¯ä»‹äºâ½¤â¼¾ç¨‹åºå’Œç¡¬ä»¶é—´ï¼Œæ“ä½œç³»ç»Ÿå¯¹â½¤â¼¾éšè—äº†ç¡¬ä»¶ç»†èŠ‚ï¼Œâ½¤â¼¾åªéœ€è¦æ ¹æ®æ“ä½œç³»ç»Ÿæä¾›çš„æ¥â¼ä¾¿èƒ½å¯¹å„ç§ç¡¬ä»¶èµ„æºè¿›â¾è®¿é—®ã€‚\nè¿™é‡Œæˆ‘ä»¬ä»¥Î¼C/OS_IIä¸ºä¾‹ï¼Œé€šè¿‡ARMKeilé‡æ„Î¼C/OS_IIä»£ç ï¼Œä¸ºåç»­çš„å®Œæ•´ç§»æ¤åšé“ºå«ï¼›\n">
<title>RTOSå­¦ä¹ å°è®°ï¼ˆä¸€ï¼‰â€”â€”Keilé‡æ„Î¼COS_II</title>

<link rel='canonical' href='https://KiWiTChen.github.io/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="RTOSå­¦ä¹ å°è®°ï¼ˆä¸€ï¼‰â€”â€”Keilé‡æ„Î¼COS_II">
<meta property='og:description' content="ä»»åŠ¡ç›®æ ‡ åµŒâ¼Šå¼æ“ä½œç³»ç»Ÿæ˜¯ä»‹äºâ½¤â¼¾ç¨‹åºå’Œç¡¬ä»¶é—´ï¼Œæ“ä½œç³»ç»Ÿå¯¹â½¤â¼¾éšè—äº†ç¡¬ä»¶ç»†èŠ‚ï¼Œâ½¤â¼¾åªéœ€è¦æ ¹æ®æ“ä½œç³»ç»Ÿæä¾›çš„æ¥â¼ä¾¿èƒ½å¯¹å„ç§ç¡¬ä»¶èµ„æºè¿›â¾è®¿é—®ã€‚\nè¿™é‡Œæˆ‘ä»¬ä»¥Î¼C/OS_IIä¸ºä¾‹ï¼Œé€šè¿‡ARMKeilé‡æ„Î¼C/OS_IIä»£ç ï¼Œä¸ºåç»­çš„å®Œæ•´ç§»æ¤åšé“ºå«ï¼›\n">
<meta property='og:url' content='https://KiWiTChen.github.io/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/'>
<meta property='og:site_name' content='KiWiT'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-03-07T17:52:26&#43;08:00'/><meta property='article:modified_time' content='2025-03-07T17:52:26&#43;08:00'/>
<meta name="twitter:title" content="RTOSå­¦ä¹ å°è®°ï¼ˆä¸€ï¼‰â€”â€”Keilé‡æ„Î¼COS_II">
<meta name="twitter:description" content="ä»»åŠ¡ç›®æ ‡ åµŒâ¼Šå¼æ“ä½œç³»ç»Ÿæ˜¯ä»‹äºâ½¤â¼¾ç¨‹åºå’Œç¡¬ä»¶é—´ï¼Œæ“ä½œç³»ç»Ÿå¯¹â½¤â¼¾éšè—äº†ç¡¬ä»¶ç»†èŠ‚ï¼Œâ½¤â¼¾åªéœ€è¦æ ¹æ®æ“ä½œç³»ç»Ÿæä¾›çš„æ¥â¼ä¾¿èƒ½å¯¹å„ç§ç¡¬ä»¶èµ„æºè¿›â¾è®¿é—®ã€‚\nè¿™é‡Œæˆ‘ä»¬ä»¥Î¼C/OS_IIä¸ºä¾‹ï¼Œé€šè¿‡ARMKeilé‡æ„Î¼C/OS_IIä»£ç ï¼Œä¸ºåç»­çš„å®Œæ•´ç§»æ¤åšé“ºå«ï¼›\n">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_fc2b629155691b95.png" width="300"
                            height="378" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥°â€‹</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">KiWiT</a></h1>
            <h2 class="site-description">æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œåœ¨è¿™é‡Œæˆ‘ä¼šåˆ†äº«ä¸€äº›è‡ªå·±çš„å­¦ä¹ æ—¥å¸¸ï¼Œå¦‚æœæœ‰ç›¸å…³é—®é¢˜ï¼Œä¹Ÿæ¬¢è¿ç§ä¿¡è®¨è®º</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/492418934'
                        target="_blank"
                        title="Blibili"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.0.0-beta2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M488.6 104.1C505.3 122.2 513 143.8 511.9 169.8V372.2C511.5 398.6 502.7 420.3 485.4 437.3C468.2 454.3 446.3 463.2 419.9 464H92.02C65.57 463.2 43.81 454.2 26.74 436.8C9.682 419.4 .7667 396.5 0 368.2V169.8C.7667 143.8 9.682 122.2 26.74 104.1C43.81 87.75 65.57 78.77 92.02 78H121.4L96.05 52.19C90.3 46.46 87.42 39.19 87.42 30.4C87.42 21.6 90.3 14.34 96.05 8.603C101.8 2.868 109.1 0 117.9 0C126.7 0 134 2.868 139.8 8.603L213.1 78H301.1L375.6 8.603C381.7 2.868 389.2 0 398 0C406.8 0 414.1 2.868 419.9 8.603C425.6 14.34 428.5 21.6 428.5 30.4C428.5 39.19 425.6 46.46 419.9 52.19L394.6 78L423.9 78C450.3 78.77 471.9 87.75 488.6 104.1H488.6zM449.8 173.8C449.4 164.2 446.1 156.4 439.1 150.3C433.9 144.2 425.1 140.9 416.4 140.5H96.05C86.46 140.9 78.6 144.2 72.47 150.3C66.33 156.4 63.07 164.2 62.69 173.8V368.2C62.69 377.4 65.95 385.2 72.47 391.7C78.99 398.2 86.85 401.5 96.05 401.5H416.4C425.6 401.5 433.4 398.2 439.7 391.7C446 385.2 449.4 377.4 449.8 368.2L449.8 173.8zM185.5 216.5C191.8 222.8 195.2 230.6 195.6 239.7V273C195.2 282.2 191.9 289.9 185.8 296.2C179.6 302.5 171.8 305.7 162.2 305.7C152.6 305.7 144.7 302.5 138.6 296.2C132.5 289.9 129.2 282.2 128.8 273V239.7C129.2 230.6 132.6 222.8 138.9 216.5C145.2 210.2 152.1 206.9 162.2 206.5C171.4 206.9 179.2 210.2 185.5 216.5H185.5zM377 216.5C383.3 222.8 386.7 230.6 387.1 239.7V273C386.7 282.2 383.4 289.9 377.3 296.2C371.2 302.5 363.3 305.7 353.7 305.7C344.1 305.7 336.3 302.5 330.1 296.2C323.1 289.9 320.7 282.2 320.4 273V239.7C320.7 230.6 324.1 222.8 330.4 216.5C336.7 210.2 344.5 206.9 353.7 206.5C362.9 206.9 370.7 210.2 377 216.5H377z"/></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/KiWiTChen'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E9%93%BE/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹é“¾</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#å†…æ ¸æ¶æ„">å†…æ ¸æ¶æ„</a></li>
    <li><a href="#æ¨¡å—ä»‹ç»">æ¨¡å—ä»‹ç»</a>
      <ol>
        <li><a href="#coreå±‚æ ¸å¿ƒä¸€èˆ¬ä¸åšä¿®æ”¹">Coreå±‚ï¼ˆæ ¸å¿ƒï¼Œä¸€èˆ¬ä¸åšä¿®æ”¹ï¼‰</a></li>
        <li><a href="#portå±‚ç§»æ¤å±‚ä¸ç¡¬ä»¶å¹³å°ç›¸å…³">Portå±‚ï¼ˆç§»æ¤å±‚ï¼Œä¸ç¡¬ä»¶å¹³å°ç›¸å…³ï¼‰</a></li>
        <li><a href="#cfgå±‚é…ç½®æ–‡ä»¶å†³å®šä»»åŠ¡å †æ ˆåŠŸèƒ½">Cfgå±‚ï¼ˆé…ç½®æ–‡ä»¶ï¼Œå†³å®šä»»åŠ¡ã€å †æ ˆã€åŠŸèƒ½ï¼‰</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#é”™è¯¯ç±»å‹1ç¼ºå°‘ä»¶æˆ–æ‰¾ä¸åˆ°ä»¶">é”™è¯¯ç±»å‹1ï¼šç¼ºå°‘â½‚ä»¶æˆ–æ‰¾ä¸åˆ°â½‚ä»¶</a></li>
        <li><a href="#é”™è¯¯ç±»å‹2ç¼ºå°‘ç›¸åº”çš„æ•°æ®ç±»å‹çš„å®šä¹‰å’Œå‡½æ•°çš„å£°æ˜">é”™è¯¯ç±»å‹2ï¼šç¼ºå°‘ç›¸åº”çš„æ•°æ®ç±»å‹çš„å®šä¹‰å’Œå‡½æ•°çš„å£°æ˜ã€‚</a></li>
        <li><a href="#é”™è¯¯ç±»å‹3os_cfghä¸­ç¼ºå°‘ç›¸åº”åŠŸèƒ½å®šä¹‰">é”™è¯¯ç±»å‹3ï¼šos_cfg.hä¸­ç¼ºå°‘ç›¸åº”åŠŸèƒ½å®šä¹‰ã€‚</a></li>
        <li><a href="#é”™è¯¯ç±»å‹4é“¾æ¥æ—¶é‡å¤å®šä¹‰">é”™è¯¯ç±»å‹4ï¼šé“¾æ¥æ—¶é‡å¤å®šä¹‰</a>
          <ol>
            <li><a href="#ä¸ºä»€ä¹ˆé“¾æ¥é˜¶æ®µæŠ¥é”™è€Œä¸æ˜¯ç¼–è¯‘">ä¸ºä»€ä¹ˆé“¾æ¥é˜¶æ®µæŠ¥é”™è€Œä¸æ˜¯ç¼–è¯‘ï¼Ÿ</a></li>
            <li><a href="#å…·ä½“è§£å†³">å…·ä½“è§£å†³</a></li>
          </ol>
        </li>
        <li><a href="#é”™è¯¯ç±»å‹5ç¼ºå°‘å¯åŠ¨ä»¶å¯¼è‡´é“¾æ¥å¤±è´¥">é”™è¯¯ç±»å‹5ï¼šç¼ºå°‘å¯åŠ¨â½‚ä»¶å¯¼è‡´é“¾æ¥å¤±è´¥</a></li>
        <li><a href="#é”™è¯¯ç±»å‹6os_cpu_cä¸­hookå‡½æ•°">é”™è¯¯ç±»å‹6ï¼šos_cpu_.cä¸­hookå‡½æ•°</a>
          <ol>
            <li><a href="#ä»€ä¹ˆæ˜¯hookå‡½æ•°">ä»€ä¹ˆæ˜¯Hookå‡½æ•°ï¼Ÿ</a></li>
            <li><a href="#å…·ä½“è§£å†³-1">å…·ä½“è§£å†³</a></li>
            <li><a href="#é”™è¯¯ç±»å‹7ä¸­æ–­æ¢å¤ä¸åˆ‡æ¢å®ç°å‡½æ•°">é”™è¯¯ç±»å‹7ï¼šä¸­æ–­ã€æ¢å¤ä¸åˆ‡æ¢å®ç°å‡½æ•°</a></li>
            <li><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ±‡ç¼–">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ±‡ç¼–ï¼Ÿ</a></li>
            <li><a href="#å…·ä½“è§£å†³-2">å…·ä½“è§£å†³</a></li>
          </ol>
        </li>
        <li><a href="#é”™è¯¯ç±»å‹8ç¼ºå°‘mainå‡½æ•°">é”™è¯¯ç±»å‹8ï¼šç¼ºå°‘mainå‡½æ•°</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#æƒ³æ³•1è°ƒå‡½æ•°">æƒ³æ³•1ï¼šè°ƒâ½¤å‡½æ•°</a></li>
        <li><a href="#æƒ³æ³•2ç‚¹äº®ç¯">æƒ³æ³•2ï¼šç‚¹äº®â¼©ç¯</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/">RTOSå­¦ä¹ å°è®°ï¼ˆä¸€ï¼‰â€”â€”Keilé‡æ„Î¼COS_II</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 07, 2025</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 12 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="ä»»åŠ¡ç›®æ ‡">ä»»åŠ¡ç›®æ ‡
</h1><p>åµŒâ¼Šå¼æ“ä½œç³»ç»Ÿæ˜¯ä»‹äºâ½¤â¼¾ç¨‹åºå’Œç¡¬ä»¶é—´ï¼Œæ“ä½œç³»ç»Ÿå¯¹â½¤â¼¾éšè—äº†ç¡¬ä»¶ç»†èŠ‚ï¼Œâ½¤â¼¾åªéœ€è¦æ ¹æ®æ“ä½œç³»ç»Ÿæä¾›çš„æ¥â¼ä¾¿èƒ½å¯¹å„ç§ç¡¬ä»¶èµ„æºè¿›â¾è®¿é—®ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ä»¥Î¼C/OS_IIä¸ºä¾‹ï¼Œé€šè¿‡ARMKeilé‡æ„Î¼C/OS_IIä»£ç ï¼Œä¸ºåç»­çš„å®Œæ•´ç§»æ¤åšé“ºå«ï¼›</p>
<p>äº†è§£æ“ä½œç³»ç»Ÿçš„åŸºæœ¬åŸç†ï¼Œäº†è§£ä»»åŠ¡åˆ›å»ºï¼Œæ ˆçš„ç”Ÿæˆï¼Œå°±ç»ªé˜Ÿåˆ—ï¼Œä¸­æ–­ï¼Œä¿¡å·é‡ç­‰åŸºæœ¬æ¦‚å¿µã€‚</p>
<h1 id="ç³»ç»Ÿç»“æ„">ç³»ç»Ÿç»“æ„
</h1><h2 id="å†…æ ¸æ¶æ„">å†…æ ¸æ¶æ„
</h2><img src="index.assets/image-20250305214253861.png" alt="image-20250305214253861" style="zoom: 80%;" />
<p>ä¸Šå›¾æ˜¯Î¼C/OS_IIçš„å†…æ ¸æ¶æ„ï¼Œæ®æ­¤æˆ‘ä»¬å¯ä»¥å‚è€ƒå®˜æ–¹æºç ç¡®å®šé‡æ„æ–‡ä»¶ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š</p>
<p>â€‹																Project&ndash;|Core&ndash;|os_core.c</p>
<p>â€‹																							|os_task.c&hellip;</p>
<p>â€‹		 	  																|Cfg   &ndash;|os_cfg.h</p>
<p>â€‹																						     |app_cfg.h</p>
<p>â€‹		       																|Port &ndash;|os_cpu.h</p>
<p>â€‹																						    |os_cpu_c.h</p>
<p>â€‹																							|os_cpu_a.s</p>
<p>â€‹		     																  |Prj       //Keilç›¸å…³ç¼–è¯‘æ–‡ä»¶</p>
<p>â€‹		      																 |User   //ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ä»¥åŠmain</p>
<h2 id="æ¨¡å—ä»‹ç»">æ¨¡å—ä»‹ç»
</h2><h3 id="coreå±‚æ ¸å¿ƒä¸€èˆ¬ä¸åšä¿®æ”¹">Coreå±‚ï¼ˆæ ¸å¿ƒï¼Œä¸€èˆ¬ä¸åšä¿®æ”¹ï¼‰
</h3><ul>
<li>os_core.cï¼šè´Ÿè´£æ“ä½œç³»ç»Ÿå†…æ ¸çš„åˆå§‹åŒ–å’Œæ ¸â¼¼åŠŸèƒ½çš„å®ç°ï¼ŒåŒ…æ‹¬ä»»åŠ¡è°ƒåº¦å™¨çš„åˆå§‹åŒ–å’Œç©ºé—²ä»»åŠ¡çš„åˆ›å»ºã€‚</li>
<li>os_task.cï¼šåŒ…å«ä»»åŠ¡ç®¡ç†ç›¸å…³çš„å‡½æ•°ï¼Œå¦‚ä»»åŠ¡çš„åˆ›å»ºã€åˆ é™¤å’Œä»»åŠ¡æ§åˆ¶å—ï¼ˆTCBï¼‰çš„æ“ä½œã€‚</li>
<li>os_flag.cï¼šå®ç°äº‹ä»¶æ ‡å¿—ç»„åŠŸèƒ½ï¼Œâ½¤äºä»»åŠ¡é—´çš„åŒæ­¥å’Œé€šä¿¡ã€‚</li>
<li>os_mem.cï¼šæä¾›å†…å­˜ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å†…å­˜å—çš„åˆ†é…å’Œé‡Šæ”¾ã€‚</li>
<li>os_tmr.cï¼šå®ç°è½¯ä»¶å®šæ—¶å™¨åŠŸèƒ½ï¼Œå…è®¸åœ¨æŒ‡å®šæ—¶é—´åæ‰§â¾ç‰¹å®šæ“ä½œã€‚</li>
<li>os_mutex.cï¼šæä¾›äº’æ–¥ä¿¡å·é‡åŠŸèƒ½ï¼Œâ½¤äºä¿æŠ¤å…±äº«èµ„æºï¼Œé˜²â½ŒåŒæ—¶è®¿é—®å¯¼è‡´çš„æ•°æ®ä¸â¼€è‡´ã€‚</li>
<li>os_sem.cï¼šuC/OS IIä¸­çš„ä¿¡å·é‡ï¼ˆSemaphoreï¼‰åŠŸèƒ½åœ¨ä»»åŠ¡é—´çš„åŒæ­¥å’Œäº’æ–¥ä¸Šèµ·ç€é‡è¦ä½œâ½¤ã€‚è¿™ä¸ªâ½‚ä»¶å®ç°äº†ä¿¡å·é‡çš„æ¥â¼å‡½æ•°</li>
<li>os_mbox.c: é‚®ç®±ï¼ˆMailboxï¼‰æ˜¯uC/OS IIâ½¤äºä»»åŠ¡é—´æ¶ˆæ¯ä¼ é€’çš„æœºåˆ¶ä¹‹â¼€ã€‚è¿™ä¸ªâ½‚ä»¶å®ç°äº†é‚®ç®±åŠŸèƒ½çš„æ¥â¼å‡½æ•°ã€‚</li>
<li>os_q.cï¼šé˜Ÿåˆ—ï¼ˆQueueï¼‰ä¹Ÿæ˜¯ä»»åŠ¡é—´é€šä¿¡å¸¸â½¤çš„â½…å¼ä¹‹â¼€ï¼Œè¿™ä¸ªâ½‚ä»¶å®ç°äº†é˜Ÿåˆ—çš„æ¥â¼å‡½æ•°ã€‚</li>
<li>ucos_ii.cï¼šè¿™ä¸ªæºâ½‚ä»¶åŒ…å«äº†uC/OS IIå†…æ ¸çš„æ ¸â¼¼åŠŸèƒ½å®ç°ï¼Œå¦‚æ“ä½œç³»ç»Ÿåˆå§‹åŒ–ã€ä»»åŠ¡è°ƒåº¦ç®—æ³•ã€æ—¶é’ŸèŠ‚æ‹å¤„ç†ã€ä¸­æ–­ç®¡ç†ã€ä»»åŠ¡åˆ›å»ºä¸åˆ é™¤ã€äº‹ä»¶æ ‡å¿—ç»„ã€ä¿¡å·é‡ã€äº’æ–¥é‡ã€é‚®ç®±å’Œé˜Ÿåˆ—ç­‰æ“ä½œçš„ä»£ç ã€‚å®ƒæ˜¯uC/OS IIæ“ä½œç³»ç»Ÿè¿â¾çš„åŸºç¡€ï¼Œå®ç°äº†å¤šä»»åŠ¡ç¯å¢ƒä¸‹çš„åŒæ­¥ä¸é€šä¿¡æœºåˆ¶ã€‚</li>
<li>ucos_ii.hï¼šè¿™ä¸ªå¤´â½‚ä»¶åŒ…å«äº†uC/OS IIå†…æ ¸ä¸­ä½¿â½¤çš„å„ç§æ•°æ®ç»“æ„çš„å®šä¹‰ï¼Œå¦‚ä»»åŠ¡ã€äº‹ä»¶ã€é“¾è¡¨ã€ä¿¡å·é‡ç­‰ï¼Œä»¥åŠå‡½æ•°å£°æ˜ã€‚</li>
</ul>
<h3 id="portå±‚ç§»æ¤å±‚ä¸ç¡¬ä»¶å¹³å°ç›¸å…³">Portå±‚ï¼ˆç§»æ¤å±‚ï¼Œä¸ç¡¬ä»¶å¹³å°ç›¸å…³ï¼‰
</h3><p><em>â­ Ports â½‚ä»¶å¤¹ä¸­çš„â½‚ä»¶åŒ…å«äº†é’ˆå¯¹ä¸åŒå¤„ç†å™¨å¹³å°çš„ç§»æ¤ä»£ç ã€‚æ¯ä¸ªå¤„ç†å™¨å¹³å°éƒ½æœ‰ä¸åŒçš„ç¡¬ä»¶æ¶æ„å’Œæ“ä½œç³»ç»Ÿæ¥â¼ï¼Œå› æ­¤éœ€è¦æ ¹æ®å¤„ç†å™¨çš„ç‰¹ç‚¹è¿›â¾ç§»æ¤ï¼Œä»¥ç¡®ä¿ uC/OS II å†…æ ¸å¯ä»¥åœ¨ç‰¹å®šå¤„ç†å™¨ä¸Šæ­£ç¡®åœ°è¿â¾ã€‚</em></p>
<p>STM32F401RET6æ˜¯ARMV7æ¶æ„çš„èŠ¯ç‰‡ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å®˜æ–¹çš„æ–‡ä»¶ä¸­èƒ½çœ‹åˆ°å¤§è‡´æœ‰è¿™ä¹ˆå‡ ä¸ªæ–‡ä»¶ï¼š</p>
<ul>
<li>
<p>os_cpu.hï¼šå®šä¹‰ä¸å¤„ç†å™¨æ¶æ„ç›¸å…³çš„æ•°æ®ç±»å‹å’Œå®ï¼Œç¡®ä¿æ“ä½œç³»ç»Ÿèƒ½å¤Ÿåœ¨ç‰¹å®šçš„ CPU ä¸Šè¿â¾ã€‚</p>
</li>
<li>
<p>os_cpu_a.asmï¼šåŒ…å«ä¸å¤„ç†å™¨æ¶æ„ç›¸å…³çš„æ±‡ç¼–ä»£ç ï¼Œå¦‚ä¸Šä¸‹â½‚åˆ‡æ¢å’Œä¸­æ–­å¤„ç†ç­‰åº•å±‚æ“ä½œã€‚</p>
</li>
<li>
<p>os_cpu_c.cï¼šå®ç°ä¸å¤„ç†å™¨æ¶æ„ç›¸å…³çš„ C è¯­â¾”å‡½æ•°ï¼Œå¦‚ä»»åŠ¡ä¸Šä¸‹â½‚åˆå§‹åŒ–ç­‰ã€‚</p>
</li>
</ul>
<h3 id="cfgå±‚é…ç½®æ–‡ä»¶å†³å®šä»»åŠ¡å †æ ˆåŠŸèƒ½">Cfgå±‚ï¼ˆé…ç½®æ–‡ä»¶ï¼Œå†³å®šä»»åŠ¡ã€å †æ ˆã€åŠŸèƒ½ï¼‰
</h3><ul>
<li>os_cfg.hï¼šâ½¤äºé…ç½®æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½å’Œç‰¹æ€§ï¼Œå¦‚ä»»åŠ¡æ•°é‡ã€å †æ ˆâ¼¤â¼©ã€æ˜¯å¦å¯â½¤æŸäº›åŠŸèƒ½ç­‰ã€‚</li>
<li>app cfg.hï¼šåŒ…å«åº”â½¤ç¨‹åºæ‰€éœ€çš„å¤´â½‚ä»¶ï¼Œç¡®ä¿ç¼–è¯‘å™¨èƒ½å¤Ÿæ‰¾åˆ°æ‰€æœ‰å¿…è¦çš„å£°æ˜å’Œå®šä¹‰ã€‚</li>
</ul>
<h1 id="é¡¹ç›®åˆ›å»º">é¡¹ç›®åˆ›å»º
</h1><ol>
<li>
<p>æ–°å»ºâ¼€ä¸ªæ€»å·¥ç¨‹â½‚ä»¶å¤¹ï¼Œå¹¶åœ¨â½‚ä»¶å¤¹ä¸‹â¾¯å†æ–°å¢â½‚ä»¶å¤¹Portã€Cfgã€Coreã€Prjï¼Œåœ¨Coreâ½‚ä»¶å¤¹ä¸­å¯¼â¼Šå®˜â½¹æ‰€ç»™çš„â½‚ä»¶ã€‚</p>
</li>
<li>
<p>æ‰“å¼€keil5ï¼ŒæŠŠå®ƒä»¬å¯¼å…¥åˆ°é¡¹ç›®ä¸­ã€‚é€‰æ‹©project-&gt;new uversionproject,é¡¹ç›®æ–‡ä»¶æ”¾è‡³Prjæ–‡ä»¶å¤¹ä¸­ï¼Œç„¶åé€‰å¥½èŠ¯ç‰‡å‹å·ï¼šSTM32F401RETx</p>
<p><img src="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305225617073.png"
	width="579"
	height="432"
	srcset="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305225617073_hu_75ee3e81f15a4e26.png 480w, /p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305225617073_hu_86a6131bdf6cd6a5.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="134"
		data-flex-basis="321px"
	
></p>
</li>
<li>
<p>å³é”®å•å‡»target1-addgroupæ–°å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶é‡å‘½åä¸ºCoreã€Portå’ŒCfgï¼Œå³é”®å•å‡»æ–‡ä»¶å¤¹ï¼Œaddexistingfilestogroupâ€˜xxxâ€™æ·»åŠ æ–‡ä»¶ã€‚<img src="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305230505443.png"
	width="944"
	height="422"
	srcset="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305230505443_hu_f92945167235251f.png 480w, /p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305230505443_hu_7c394f54adb519ae.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="223"
		data-flex-basis="536px"
	
></p>
</li>
<li>
<p>æ·»åŠ å¤´æ–‡ä»¶è·¯å¾„ã€‚æ‰“å¼€é­”æœ¯æ£’ï¼Œåœ¨C/C++å’ŒAsmé‡Œçš„IncludePathä¸­å†™å…¥Cç¨‹åºå’Œæ±‡ç¼–æ–‡ä»¶çš„è·¯å¾„ã€‚</p>
</li>
</ol>
<p><img src="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305230540754.png"
	width="647"
	height="461"
	srcset="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305230540754_hu_92d59d223c969723.png 480w, /p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305230540754_hu_e6e6333881438ad5.png 1024w"
	loading="lazy"
	
		alt="image-20250305230540754"
	
	
		class="gallery-image" 
		data-flex-grow="140"
		data-flex-basis="336px"
	
></p>
<h1 id="æŠ¥é”™è§£å†³">æŠ¥é”™è§£å†³
</h1><h3 id="é”™è¯¯ç±»å‹1ç¼ºå°‘ä»¶æˆ–æ‰¾ä¸åˆ°ä»¶">é”™è¯¯ç±»å‹1ï¼šç¼ºå°‘â½‚ä»¶æˆ–æ‰¾ä¸åˆ°â½‚ä»¶
</h3><p><strong>è§£å†³æ–¹å¼ï¼šåˆ›å»ºå¯¹åº”æ–‡ä»¶ï¼Œæš‚æ—¶â€œéª—â€è¿‡ç¼–è¯‘å™¨</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="p">.</span><span class="err">\</span><span class="n">Core</span><span class="err">\</span><span class="n">ucos_ii</span><span class="p">.</span><span class="nf">h</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span><span class="o">:</span> <span class="nl">error</span><span class="p">:</span> <span class="err">#</span><span class="mi">5</span><span class="o">:</span> <span class="n">cannot</span> <span class="n">open</span> <span class="n">source</span> <span class="n">input</span> <span class="n">file</span> <span class="s">&#34;app_cfg.h&#34;</span><span class="o">:</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="n">or</span> <span class="n">directory</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªæŠ¥é”™ä¿¡æ¯æâ½°æˆ‘ä»¬ç¼ºå°‘app_cfg.hâ½‚ä»¶ï¼Œäºæ˜¯æˆ‘ä»¬å…ˆå»ºâ½´â¼€ä¸ªç©ºçš„app_cfg.hâ½‚ä»¶åœ¨Cfgâ½‚ä»¶å¤¹ä¸­ã€‚</p>
<p>åŒç†æ·»åŠ os_cfg.hã€os_cpu.h</p>
<h3 id="é”™è¯¯ç±»å‹2ç¼ºå°‘ç›¸åº”çš„æ•°æ®ç±»å‹çš„å®šä¹‰å’Œå‡½æ•°çš„å£°æ˜">é”™è¯¯ç±»å‹2ï¼šç¼ºå°‘ç›¸åº”çš„æ•°æ®ç±»å‹çš„å®šä¹‰å’Œå‡½æ•°çš„å£°æ˜ã€‚
</h3><p><strong>è§£å†³æ–¹å¼ï¼šåœ¨os_cpu.hâ½‚ä»¶ä¸­æ·»åŠ ç›¸åº”çš„å®šä¹‰</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="p">.</span><span class="err">\</span><span class="n">Core</span><span class="err">\</span><span class="n">ucos_ii</span><span class="p">.</span><span class="nf">h</span><span class="p">(</span><span class="mi">372</span><span class="p">)</span><span class="o">:</span> <span class="nl">error</span><span class="p">:</span> <span class="err">#</span><span class="mi">20</span><span class="o">:</span> <span class="n">identifier</span> <span class="s">&#34;INT8U&#34;</span> <span class="n">is</span> <span class="n">undefined</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ä¸ºä»€ä¹ˆéœ€è¦å®šä¹‰ä¸åŒçš„å˜é‡ç±»å‹INT8U,INT16Uç­‰ï¼Ÿ</p>
<p>ç”±äºsigned intï¼Œunsigned intç­‰åŸâ½£ç±»å‹æ—¶ï¼Œå…¶å®é™…ä½æ•°å–å†³äºå¤„ç†å™¨ã€‚â½å¦‚åœ¨16ä½ç³»ç»Ÿä¸­inté€šå¸¸ä¸º16ä½ï¼Œâ½½åœ¨32/64ä½ç³»ç»Ÿä¸­ï¼Œinté€šå¸¸ä¸º32ä½ã€‚è¿™ä¼šå¯¼è‡´ç§»æ¤æ—¶ä¸åŒå¹³å°æ—¶äº§â½£æ•°æ®æº¢å‡ºç­‰æƒ…å†µã€‚</p>
<p>è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œé€šè¿‡typedefæ˜ç¡®å®šä¹‰æ•°æ®ç±»å‹çš„ä½æ•°ï¼Œä¿è¯äº†è·¨å¹³å°çš„â¼€è‡´æ€§ã€‚</p></blockquote>
<p>ä¸‹è¡¨æ˜¯å¯¹äºÎ¼C/OS_IIä¸­æ•°æ®ç±»å‹çš„å®šä¹‰å‚è€ƒï¼š</p>
<p><img src="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305232437124.png"
	width="657"
	height="368"
	srcset="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305232437124_hu_ef1a4e0edd1ffda2.png 480w, /p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250305232437124_hu_9f6306e8ae6bd07d.png 1024w"
	loading="lazy"
	
		alt="image-20250305232437124"
	
	
		class="gallery-image" 
		data-flex-grow="178"
		data-flex-basis="428px"
	
></p>
<p>æ‰€ä»¥é€‰æ‹©åœ¨os_cpu.hæ–‡ä»¶ä¸­å®šä¹‰ç›¸å…³æ•°æ®ç±»å‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">//æ•°æ®ç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">BOOLEAN</span><span class="p">;</span> <span class="c1">// å®šä¹‰å¸ƒå°”ç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">INT8U</span><span class="p">;</span> <span class="c1">// â½†ç¬¦å·8ä½æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">char</span> <span class="n">INT8S</span><span class="p">;</span> <span class="c1">// æœ‰ç¬¦å·8ä½æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">INT16U</span><span class="p">;</span> <span class="c1">// â½†ç¬¦å·16ä½æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">short</span> <span class="n">INT16S</span><span class="p">;</span> <span class="c1">// æœ‰ç¬¦å·16ä½æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">INT32U</span><span class="p">;</span> <span class="c1">// â½†ç¬¦å·32ä½æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">int</span> <span class="n">INT32S</span><span class="p">;</span> <span class="c1">// æœ‰ç¬¦å·32ä½æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">float</span> <span class="n">FP32</span><span class="p">;</span> <span class="c1">// å•ç²¾åº¦æµ®ç‚¹æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">double</span> <span class="n">FP64</span><span class="p">;</span> <span class="c1">// åŒç²¾åº¦æµ®ç‚¹æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">OS_STK</span><span class="p">;</span> <span class="c1">// æ¯ä¸ªæ ˆæ¡â½¬ä¸º32ä½å®½
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">OS_CPU_SR</span><span class="p">;</span><span class="c1">// å®šä¹‰CPUçŠ¶æ€å¯„å­˜å™¨çš„â¼¤â¼©ï¼ˆPSR = 32ä½ï¼‰
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é”™è¯¯ç±»å‹3os_cfghä¸­ç¼ºå°‘ç›¸åº”åŠŸèƒ½å®šä¹‰">é”™è¯¯ç±»å‹3ï¼šos_cfg.hä¸­ç¼ºå°‘ç›¸åº”åŠŸèƒ½å®šä¹‰ã€‚
</h3><p><strong>è§£å†³æ–¹å¼ï¼šå‚è€ƒå®˜æ–¹æºç ä¸­cfgæ–‡ä»¶ï¼Œåœ¨os_cfg.hâ½‚ä»¶ä¸­æ·»åŠ ç›¸åº”çš„å®å®šä¹‰</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">.\ucos\ucos_ii.h(1482) : error : #35 : #error directive:&#34;OS_CFG.H,MissingOS_FLAG_EN: Enable(1) or Disable (0) code generation for Event Flags
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬åœ¨os_cfg.hæ–‡ä»¶ä¸­æš‚æ—¶å¯¹ç›¸åº”å‚æ•°é…ç½®å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* ---------------------- MISCELLANEOUS ----------------------- */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_APP_HOOKS_EN 1u </span><span class="cm">/* Application-defined hooks arecalled from the uC/OS-II hooks */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_ARG_CHK_EN 1u </span><span class="cm">/* Enable (1) or Disable (0) argumentchecking */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_CPU_HOOKS_EN 1u </span><span class="cm">/* uC/OS-II hooks are found in theprocessor port files */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_DEBUG_EN 0u </span><span class="cm">/* Enable(1) debug variables*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_EVENT_MULTI_EN 1u </span><span class="cm">/* Include code for OSEventPendMulti()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_EVENT_NAME_EN 1u </span><span class="cm">/* Enable names for Sem, Mutex, Mboxand Q */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_LOWEST_PRIO 63u </span><span class="cm">/* Defines the lowest priority thatcan be assigned ... */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>								<span class="cm">/* ... MUST NEVER be higher than 254!*/</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_MAX_EVENTS 10u </span><span class="cm">/* Max. number of event control blocksin your application */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MAX_FLAGS 5u </span><span class="cm">/* Max. number of Event Flag Groupsin your application */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MAX_MEM_PART 5u </span><span class="cm">/* Max. number of memory partitions*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MAX_QS 4u </span><span class="cm">/* Max. number of queue control blocksin your application */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MAX_TASKS 20u </span><span class="cm">/* Max. number of tasks in yourapplication, MUST be &gt;= 2 */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_SCHED_LOCK_EN 1u </span><span class="cm">/* Include code for OSSchedLock() andOSSchedUnlock() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_TICK_STEP_EN 1u </span><span class="cm">/* Enable tick stepping feature foruC/OS-View */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TICKS_PER_SEC 100u </span><span class="cm">/* Set the number of ticks in onesecond */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TLS_TBL_SIZE 0u </span><span class="cm">/* Size of Thread-Local Storage Table*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* --------------------- TASK STACK SIZE ---------------------- */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_TMR_STK_SIZE 128u </span><span class="cm">/* Timer task stack size (# ofOS_STK wide entries) */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_STAT_STK_SIZE 128u </span><span class="cm">/* Statistics task stack size (# ofOS_STK wide entries) */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_IDLE_STK_SIZE 128u </span><span class="cm">/* Idle task stack size (# ofOS_STK wide entries) */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* --------------------- TASK MANAGEMENT ---------------------- */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_CHANGE_PRIO_EN 1u </span><span class="cm">/* Include code forOSTaskChangePrio() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_CREATE_EN 1u </span><span class="cm">/* Include code for OSTaskCreate()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_CREATE_EXT_EN 1u </span><span class="cm">/* Include code forOSTaskCreateExt() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_DEL_EN 1u </span><span class="cm">/* Include code for OSTaskDel()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_NAME_EN 1u </span><span class="cm">/* Enable task names*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_PROFILE_EN 1u </span><span class="cm">/* Include variables in OS_TCB forprofiling */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_QUERY_EN 1u </span><span class="cm">/* Include code for OSTaskQuery()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_REG_TBL_SIZE 1u </span><span class="cm">/* Size of task variables array(#of INT32U entries) */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_STAT_EN 1u </span><span class="cm">/* Enable (1) or Disable(0) thestatistics task */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_STAT_STK_CHK_EN 1u </span><span class="cm">/* Check task stacks fromstatistic task */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_SUSPEND_EN 1u </span><span class="cm">/* Include code forOSTaskSuspend() and OSTaskResume() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TASK_SW_HOOK_EN 1u </span><span class="cm">/* Include code for OSTaskSwHook()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* ----------------------- EVENT FLAGS ------------------------ */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_FLAG_EN 1u </span><span class="cm">/* Enable (1) or Disable (0) codegeneration for EVENT FLAGS */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_FLAG_ACCEPT_EN 1u </span><span class="cm">/* Include code for OSFlagAccept()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_FLAG_DEL_EN 1u </span><span class="cm">/* Include code for OSFlagDel()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_FLAG_NAME_EN 1u </span><span class="cm">/* Enable names for event flaggroup */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_FLAG_QUERY_EN 1u </span><span class="cm">/* Include code for OSFlagQuery()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_FLAG_WAIT_CLR_EN 1u </span><span class="cm">/* Include code for Wait on ClearEVENT FLAGS */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_FLAGS_NBITS 16u </span><span class="cm">/* Size in #bits of OS_FLAGS data type(8, 16 or 32) */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* -------------------- MESSAGE MAILBOXES --------------------- */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_MBOX_EN 1u </span><span class="cm">/* Enable (1) or Disable (0) codegeneration for MAILBOXES */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MBOX_ACCEPT_EN 1u </span><span class="cm">/* Include code for OSMboxAccept()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MBOX_DEL_EN 1u </span><span class="cm">/* Include code for OSMboxDel()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MBOX_PEND_ABORT_EN 1u </span><span class="cm">/* Include code forOSMboxPendAbort() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MBOX_POST_EN 1u </span><span class="cm">/* Include code for OSMboxPost()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MBOX_POST_OPT_EN 1u </span><span class="cm">/* Include code forOSMboxPostOpt() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MBOX_QUERY_EN 1u </span><span class="cm">/* Include code for OSMboxQuery()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* --------------------- MEMORY MANAGEMENT -------------------- */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_MEM_EN 1u </span><span class="cm">/* Enable (1) or Disable (0) codegeneration for MEMORY MANAGER */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MEM_NAME_EN 1u </span><span class="cm">/* Enable memory partition names*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MEM_QUERY_EN 1u </span><span class="cm">/* Include code for OSMemQuery()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* ---------------- MUTUAL EXCLUSION SEMAPHORES --------------- */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_MUTEX_EN 1u </span><span class="cm">/* Enable (1) or Disable (0) codegeneration for MUTEX */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MUTEX_ACCEPT_EN 1u </span><span class="cm">/* Include code forOSMutexAccept() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_MUTEX_DEL_EN 1u </span><span class="cm">/* Include code for OSMutexDel()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_MUTEX_QUERY_EN 1u </span><span class="cm">/* Include code for OSMutexQuery()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* ---------------------- MESSAGE QUEUES ---------------------- */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_Q_EN 1u </span><span class="cm">/* Enable (1) or Disable (0) codegeneration for QUEUES */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_Q_ACCEPT_EN 1u </span><span class="cm">/* Include code for OSQAccept()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_Q_DEL_EN 1u </span><span class="cm">/* Include code for OSQDel()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_Q_FLUSH_EN 1u </span><span class="cm">/* Include code for OSQFlush()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_Q_PEND_ABORT_EN 1u </span><span class="cm">/* Include code for OSQPendAbort()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_Q_POST_EN 1u </span><span class="cm">/* Include code for OSQPost()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_Q_POST_FRONT_EN 1u </span><span class="cm">/* Include code for OSQPostFront()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_Q_POST_OPT_EN 1u </span><span class="cm">/* Include code for OSQPostOpt()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_Q_QUERY_EN 1u </span><span class="cm">/* Include code for OSQQuery()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* ------------------------ SEMAPHORES ------------------------ */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_SEM_EN 1u </span><span class="cm">/* Enable (1) or Disable (0) codegeneration for SEMAPHORES */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_SEM_ACCEPT_EN 1u </span><span class="cm">/* Include code for OSSemAccept()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_SEM_DEL_EN 1u </span><span class="cm">/* Include code for OSSemDel()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_SEM_PEND_ABORT_EN 1u </span><span class="cm">/* Include code forOSSemPendAbort() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_SEM_QUERY_EN 1u </span><span class="cm">/* Include code for OSSemQuery()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_SEM_SET_EN 1u </span><span class="cm">/* Include code for OSSemSet()*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* --------------------- TIME MANAGEMENT ---------------------- */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_TIME_DLY_HMSM_EN 1u </span><span class="cm">/* Include code forOSTimeDlyHMSM() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TIME_DLY_RESUME_EN 1u </span><span class="cm">/* Include code forOSTimeDlyResume() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_TIME_GET_SET_EN 1u </span><span class="cm">/* Include code for OSTimeGet()and OSTimeSet() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TIME_TICK_HOOK_EN 1u </span><span class="cm">/* Include code forOSTimeTickHook() */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* --------------------- TIMER MANAGEMENT --------------------- */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_TMR_EN 0u </span><span class="cm">/* Enable (1) or Disable (0) codegeneration for TIMERS */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TMR_CFG_MAX 16u </span><span class="cm">/* Maximum number of timers*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TMR_CFG_NAME_EN 1u </span><span class="cm">/* Determine timer names*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TMR_CFG_WHEEL_SIZE 7u </span><span class="cm">/* Size of timer wheel (#Spokes)*/</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TMR_CFG_TICKS_PER_SEC 10u </span><span class="cm">/* Rate at which timer managementtask runs (Hz) */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* ---------------------- TRACE RECORDER ---------------------- */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define OS_TRACE_EN 0u </span><span class="cm">/* Enable (1) or Disable (0) uC/OS-IITrace instrumentation */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TRACE_API_ENTER_EN 0u </span><span class="cm">/* Enable (1) or Disable (0) uC/OS-IITrace API enter instrum. */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OS_TRACE_API_EXIT_EN 0u </span><span class="cm">/* Enable (1) or Disable (0) uC/OS-IITrace API exit instrum. */</span><span class="cp">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>åœ¨åç»­çš„å­¦ä¹ ä¸­ï¼Œå¯ä»¥æŠŠç›¸å…³çš„åŠŸèƒ½ç»™ç¦â½¤ï¼Œæ³¨æ„éƒ¨åˆ†å‚æ•°çš„å–å€¼èŒƒå›´ï¼Œè‹¥è®¾å®šçš„å‚æ•°ä¸åœ¨èŒƒå›´å†…åˆ™ä¼šæŠ¥é”™ã€‚</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define OS_TMR_EN 0u </span><span class="cm">/* Enable (1) or Disable (0) code generation for TIMERS */</span><span class="cp">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å°† OS_TMR_EN è®¾ç½®ä¸º 0u ä¼šä½¿ uC/OS-II ç¦â½¤å®šæ—¶å™¨åŠŸèƒ½çš„ä»£ç â½£æˆã€‚STM32F401å…·æœ‰å¤šä¸ªå®šæ—¶å™¨Timerï¼Œå¯ä»¥æ»¡â¾œå®šæ—¶ä¸­æ–­ã€PWMè¾“å‡ºã€è¾“â¼Šæ•è·ã€è¾“å‡ºâ½è¾ƒç­‰åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ä½¿â½¤Systickï¼ˆSysTickæ˜¯ Cortex-M å†…æ ¸ä¸­çš„â¼€ä¸ªç³»ç»Ÿå®šæ—¶å™¨ï¼Œå±äºå†…æ ¸çš„â¼€éƒ¨åˆ†ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define OS_DEBUG_EN 0u </span><span class="cm">/* Enable(1) debug variables*/</span><span class="cp">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>OS_DEBUGè¿™ä¸ªåŠŸèƒ½åœ¨åç»­çš„æ“ä½œä¸­æ²¡ä»€ä¹ˆâ½¤ä½†æ˜¯ä¼šäº§â½£æŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°†è¿™ä¸ªåŠŸèƒ½ç»™å…³é—­ã€‚</p>
<h3 id="é”™è¯¯ç±»å‹4é“¾æ¥æ—¶é‡å¤å®šä¹‰">é”™è¯¯ç±»å‹4ï¼šé“¾æ¥æ—¶é‡å¤å®šä¹‰
</h3><p><strong>è§£å†³æ–¹æ³•ï¼šæœç´¢é‡å¤å®šä¹‰çš„æ–‡ä»¶ï¼Œè°ƒæ•´include path</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="p">.</span><span class="err">\</span><span class="n">Objects</span><span class="err">\</span><span class="n">projects</span><span class="p">.</span><span class="nl">axf</span><span class="p">:</span> <span class="nl">Error</span><span class="p">:</span> <span class="nl">L6200E</span><span class="p">:</span> <span class="n">Symbol</span> <span class="n">OSEventNameGet</span> <span class="n">multiply</span> <span class="nf">defined</span> <span class="p">(</span><span class="n">by</span> <span class="n">ucos_ii</span><span class="p">.</span><span class="n">o</span> <span class="n">and</span> <span class="n">os_core</span><span class="p">.</span><span class="n">o</span><span class="p">).</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šè¿°æŠ¥é”™è¯´çš„æ˜¯OSEventNameGetåœ¨ä¸¤ä¸ªæ–‡ä»¶ucos_ii.o and os_core.oä¸­è¢«é‡å¤å®šä¹‰ï¼›</p>
<p>è¿™ä¸¤ä¸ª.oæ–‡ä»¶éƒ½æ˜¯ç¼–è¯‘å™¨ç¼–è¯‘åŒå.cæ–‡ä»¶ç”Ÿæˆçš„å¯¹è±¡ï¼ˆobjectï¼‰æ–‡ä»¶ã€‚</p>
<p>è¿™é‡Œä¸€èˆ¬çš„æ€è·¯æ˜¯å€ŸåŠ©CTRL+Fæœç´¢å¯¹åº”å˜é‡ï¼Œå®šä½é‡å¤éƒ¨åˆ†ï¼Œç„¶åè°ƒæ•´.hæˆ–è€….cçš„â€œ#include &lsquo;xxx&rsquo; &ldquo;éƒ¨åˆ†ã€‚</p>
<h4 id="ä¸ºä»€ä¹ˆé“¾æ¥é˜¶æ®µæŠ¥é”™è€Œä¸æ˜¯ç¼–è¯‘">ä¸ºä»€ä¹ˆé“¾æ¥é˜¶æ®µæŠ¥é”™è€Œä¸æ˜¯ç¼–è¯‘ï¼Ÿ
</h4><p><strong>â€”â€”ç®€å•ç†è§£ä¸ºé¢„å¤„ç†ç²˜è´´includeéƒ¨åˆ†çš„ä»£ç å—ï¼Œç¼–è¯‘ä¸æŠ¥é”™ï¼Œä½†æ˜¯é“¾æ¥æ—¶ä¼šå‘ç°â€é‡å¤å®šä¹‰â€œ</strong></p>
<p>å¯ä»¥å‚è€ƒã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹è¿™æœ¬ä¹¦ï¼Œæˆ–è€…<a class="link" href="https://zhuanlan.zhihu.com/p/476697014"  target="_blank" rel="noopener"
    >è¿™ç¯‡åšå®¢</a>ï¼Œ<img src="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250307165645211.png"
	width="831"
	height="129"
	srcset="/p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250307165645211_hu_2d2ad451eaa0bdb2.png 480w, /p/rtos%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%E4%B8%80keil%E9%87%8D%E6%9E%84%CE%BCcos_ii/index.assets/image-20250307165645211_hu_f9553803bd939f5c.png 1024w"
	loading="lazy"
	
		alt="image-20250307165645211"
	
	
		class="gallery-image" 
		data-flex-grow="644"
		data-flex-basis="1546px"
	
></p>
<ol>
<li>é¢„å¤„ç†å™¨ä¸»è¦å°†é¡¹ç›®ä»£ç è¿›è¡Œå¤„ç†ï¼Œåˆ é™¤æ³¨é‡Šã€#includeã€å±•å¼€å®å®šä¹‰ç­‰ï¼›</li>
<li>ç¼–è¯‘å™¨åˆ™æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„è¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€è¯­ä¹‰åˆ†æç­‰è¿‡ç¨‹å¾—åˆ°.sæ–‡ä»¶ï¼›</li>
<li>ç»è¿‡æ±‡ç¼–å™¨å¤„ç†åæ±‡ç¼–å¾—åˆ°.oæ–‡ä»¶;</li>
<li>ä¹‹åé“¾æ¥å™¨ä¼šæ£€æŸ¥æ‰€æœ‰â½¬æ ‡â½‚ä»¶å’Œåº“â½‚ä»¶ä¸­çš„ç¬¦å·å®šä¹‰å’Œå¼•â½¤ï¼›</li>
<li>æœ€ç»ˆç”Ÿæˆå¯æ‰§è¡Œç¨‹åºã€‚</li>
</ol>
<h4 id="å…·ä½“è§£å†³">å…·ä½“è§£å†³
</h4><p>åœ¨é‡æ„é¡¹ç›®ä¸­ï¼Œucos_ii.cæ–‡ä»¶â€ç²˜è´´â€œäº†å¤šä¸ªos_xxx.cæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè€Œé¡¹ç›®ä¸­os_xxx.cä¹Ÿä¼šè¢«ç¼–è¯‘ï¼Œæœ€ååœ¨é“¾æ¥æ—¶å‘ç°é‡å®šä¹‰ï¼›</p>
<img src="../../../../../../../../administractor Cheng/Desktop/markdown/å››è½´IIæŒ‘æˆ˜ç‚¹ä¸€ARMKeilé‡æ„UC_OSIIé¡¹ç›®.assets/image-20250307171502174.png" alt="image-20250307171502174" style="zoom:50%;" />
<p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å³é”®coreï¼Œç‚¹å‡»é­”æœ¯æ£’ï¼Œå…³é—­æ­¤éƒ¨åˆ†çš„ç¼–è¯‘åŒ…å«ã€‚</p>
<img src="index.assets/image-20250307171905834.png" alt="image-20250307171905834" style="zoom:50%;" />
<h3 id="é”™è¯¯ç±»å‹5ç¼ºå°‘å¯åŠ¨ä»¶å¯¼è‡´é“¾æ¥å¤±è´¥">é”™è¯¯ç±»å‹5ï¼šç¼ºå°‘å¯åŠ¨â½‚ä»¶å¯¼è‡´é“¾æ¥å¤±è´¥
</h3><p><strong>è§£å†³æ–¹æ³•ï¼šå¯¼å…¥å¯¹åº”å¯åŠ¨æ–‡ä»¶.s</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="p">.</span><span class="err">\</span><span class="n">Objects</span><span class="err">\</span><span class="n">ucosii</span><span class="p">.</span><span class="nl">axf</span><span class="p">:</span> <span class="nl">Error</span><span class="p">:</span> <span class="nl">L6320W</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="o">--</span><span class="n">entry</span> <span class="n">command</span><span class="p">.</span><span class="n">Cannot</span> <span class="n">find</span> <span class="n">argument</span> <span class="err">&#39;</span><span class="n">Reset_Handler</span><span class="err">&#39;</span> <span class="c1">//æˆªå–äº†ä¸€æ¡
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼ºå°‘äº†å¯åŠ¨æ–‡ä»¶ï¼Œç¨‹åºæ‰¾ä¸åˆ°æ‰§è¡Œå…¥å£ä»¥åŠä¸­æ–­å‘é‡è¡¨ç­‰ï¼Œæ‰€ä»¥ä¹Ÿä¼šæŠ¥é”™ï¼Œåç»­æˆ‘ä»¬è¿˜ä¼šå¯¹å¯åŠ¨æ–‡ä»¶è¿›è¡Œè¿›ä¸€æ­¥åˆ†æï¼›</p>
<p>è¿™é‡Œåªéœ€è¦æ–°å»ºä¸€ä¸ªStartupæ–‡ä»¶å¤¹ï¼Œå¯¼å…¥startup_stm32f40_41xxx.sã€‚</p>
<h3 id="é”™è¯¯ç±»å‹6os_cpu_cä¸­hookå‡½æ•°">é”™è¯¯ç±»å‹6ï¼šos_cpu_.cä¸­hookå‡½æ•°
</h3><p><strong>è§£å†³æ–¹æ³•ï¼šæš‚æ—¶ç©ºå®šä¹‰å‡½æ•°ï¼Œåç»­è¡¥å……å®Œå–„</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="p">.</span><span class="err">\</span><span class="n">Objects</span><span class="err">\</span><span class="n">test</span><span class="p">.</span><span class="nl">axf</span><span class="p">:</span> <span class="nl">Error</span><span class="p">:</span> <span class="nl">L6218E</span><span class="p">:</span> <span class="n">Undefined</span> <span class="n">symbol</span> <span class="nf">OSCtxSw</span> <span class="p">(</span><span class="n">referred</span> <span class="n">from</span> <span class="n">os_core</span><span class="p">.</span><span class="n">o</span><span class="p">).</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ä»€ä¹ˆæ˜¯hookå‡½æ•°">ä»€ä¹ˆæ˜¯Hookå‡½æ•°ï¼Ÿ
</h4><p>é’©å­å‡½æ•°æ˜¯uC/OS-IIå†…æ ¸åœ¨ç‰¹å®šæ“ä½œï¼ˆå¦‚ä»»åŠ¡åˆ›å»ºã€åˆ é™¤ã€åˆ‡æ¢ç­‰ï¼‰å‰åè°ƒç”¨çš„ç©ºå‡½æ•°ï¼ˆé»˜è®¤ä¸ºç©ºå®ç°ï¼‰ã€‚å¼€å‘è€…é€šè¿‡é‡å†™è¿™äº›å‡½æ•°ï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹å†…æ ¸æºç çš„æƒ…å†µä¸‹æ‰©å±•åŠŸèƒ½ã€‚å¸¸è§ç”¨é€”åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>è°ƒè¯•ä¸ç›‘æ§</strong>ï¼šè®°å½•ä»»åŠ¡åˆ›å»º/åˆ é™¤æ—¶é—´ã€å †æ ˆä½¿ç”¨æƒ…å†µç­‰ã€‚</li>
<li><strong>èµ„æºç®¡ç†</strong>ï¼šåœ¨ä»»åŠ¡åˆ›å»ºæ—¶åˆå§‹åŒ–è‡ªå®šä¹‰æ•°æ®ç»“æ„æˆ–å¤–è®¾ã€‚</li>
<li><strong>æ€§èƒ½åˆ†æ</strong>ï¼šç»Ÿè®¡ä»»åŠ¡æ‰§è¡Œæ—¶é—´æˆ–ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ã€‚</li>
<li><strong>å®‰å…¨æ£€æŸ¥</strong>ï¼šéªŒè¯ä»»åŠ¡å‚æ•°çš„åˆæ³•æ€§ã€‚</li>
</ul>
<p>ä»¥<code>OSTaskCreateHook</code>ä¸ºä¾‹ï¼Œå®ƒåœ¨ä»»åŠ¡åˆ›å»ºåè¢«è°ƒç”¨ï¼Œå…è®¸å¼€å‘è€…åœ¨ä»»åŠ¡é¦–æ¬¡è¿è¡Œå‰æ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ã€‚</p>
<blockquote>
<p>ç®€å•æ¥è®²å°±æ˜¯è·å–æ“ä½œç³»ç»Ÿçš„ç›¸å…³çŠ¶æ€</p></blockquote>
<h4 id="å…·ä½“è§£å†³-1">å…·ä½“è§£å†³
</h4><p>æˆ‘ä»¬éœ€è¦æ–°å»ºâ¼€ä¸ªos_cpu_c.câ½‚ä»¶å’Œâ¼€ä¸ªos_cpu_a.sâ½‚ä»¶ï¼Œåœ¨å…¶ä¸­è¡¥å……ç¼ºå°‘çš„å‡½æ•°å®ç°ï¼Œâ½¬å‰æˆ‘ä»¬ä¸éœ€è¦è¡¥å…¨å…·ä½“çš„å‡½æ•°å®ç°ç»†èŠ‚ï¼Œåªéœ€è¦å†™â¼€ä¸ªç©ºå®šä¹‰æ¥éª—è¿‡ç¼–è¯‘å™¨ã€‚</p>
<p>åœ¨os_cpu_c.câ½‚ä»¶ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰ç©ºçš„ç³»ç»Ÿåˆå§‹åŒ–å‡½æ•°ã€é’©â¼¦å‡½æ•°ã€cpuå¼‚å¸¸æ ˆåŸºåœ°å€å’Œè¿™æ˜¯å†…æ ¸å¯â½¤</p>
<p>çš„ä¼˜å…ˆçº§è¾¹ç•Œã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;os_cpu.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">// ç³»ç»Ÿåˆå§‹åŒ–å‡½æ•°ï¼Œé€šå¸¸â½¤äºè®¾ç½®ç¡¬ä»¶ç›¸å…³çš„è®¾ç½®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">SystemInit</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// å®šä¹‰ç©ºçš„é’©â¼¦å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">OSInitHookBegin</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">OSInitHookEnd</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">OSTCBInitHook</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">OSTaskCreateHook</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">OSTaskIdleHook</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">OSTaskReturnHook</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">OSTaskSwHook</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ä»»åŠ¡å †æ ˆåˆå§‹åŒ–å‡½æ•°ï¼Œä¸ºæ–°ä»»åŠ¡åˆ†é…å †æ ˆç©ºé—´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">OS_STK</span> <span class="o">*</span><span class="nf">OSTaskStkInit</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">task</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">p_arg</span><span class="p">),</span> <span class="kt">void</span> <span class="o">*</span><span class="n">p_arg</span><span class="p">,</span> <span class="n">OS_STK</span> <span class="o">*</span><span class="n">ptos</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">INT16U</span> <span class="n">opt</span><span class="p">){</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">ptos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// å®šä¹‰â¼€ä¸ªç©ºçš„CPUå¼‚å¸¸æ ˆåŸºåœ°å€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">OS_CPU_ExceptStkBase</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// è®¾ç½®å†…æ ¸å¯â½¤çš„ä¼˜å…ˆçº§è¾¹ç•Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">OS_KA_BASEPRI_Boundary</span><span class="p">(){}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é”™è¯¯ç±»å‹7ä¸­æ–­æ¢å¤ä¸åˆ‡æ¢å®ç°å‡½æ•°">é”™è¯¯ç±»å‹7ï¼šä¸­æ–­ã€æ¢å¤ä¸åˆ‡æ¢å®ç°å‡½æ•°
</h4><p><strong>è§£å†³æ–¹æ³•ï¼šç¼–å†™æ±‡ç¼–å‡½æ•°ç¡®å®šç›¸å…³é€»è¾‘</strong></p>
<h4 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ±‡ç¼–">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ±‡ç¼–ï¼Ÿ
</h4><p>åœ¨os_cpu_a.sâ½‚ä»¶ä¸­ï¼Œå®ç°çš„æ˜¯ä¸å¤„ç†å™¨ç›¸å…³çš„å‡½æ•°,è¿™â¼€éƒ¨åˆ†çš„å‡½æ•°æ¶‰åŠCPU ç‰¹æƒå¯„å­˜å™¨çš„è®¿é—®ã€å¯„å­˜å™¨çŠ¶æ€çš„ä¿å­˜ä¸æ¢å¤ï¼Œä»¥åŠä»»åŠ¡ä¸Šä¸‹â½‚åˆ‡æ¢ã€‚</p>
<p>è¿™äº›æ“ä½œéœ€è¦å¯¹CPU ä½“ç³»ç»“æ„å’ŒæŒ‡ä»¤é›†è¿›â¾ç²¾ç¡®æ§åˆ¶ï¼Œâ½½â¾¼çº§è¯­â¾”ï¼ˆå¦‚ Cï¼‰â½†æ³•ä¸æä¾›ç›´æ¥è¯»å†™ç‰¹å®šç¡¬ä»¶å¯„å­˜å™¨ï¼ˆå¦‚ä¸­æ–­å¯„å­˜å™¨PRIMASKã€å †æ ˆPSPã€ä»»åŠ¡æ§åˆ¶å—TCBï¼‰çš„æœºåˆ¶ï¼Œä¹Ÿéš¾ä»¥ç¡®ä¿ä»»åŠ¡åˆ‡æ¢çš„ç²¾ç¡®æ€§å’Œâ¾¼æ•ˆæ€§ã€‚</p>
<h4 id="å…·ä½“è§£å†³-2">å…·ä½“è§£å†³
</h4><p>åˆ›å»ºos_cpu_a.sæ–‡ä»¶ï¼Œå®šä¹‰ç›¸å…³å‡½æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nf">EXPORT</span> <span class="no">OS_CPU_SR_Save</span>
</span></span><span class="line"><span class="cl"><span class="nf">EXPORT</span> <span class="no">OS_CPU_SR_Restore</span>
</span></span><span class="line"><span class="cl"><span class="nf">EXPORT</span> <span class="no">OSCtxSw</span>
</span></span><span class="line"><span class="cl"><span class="nf">EXPORT</span> <span class="no">OSIntCtxSw</span>
</span></span><span class="line"><span class="cl"><span class="nf">EXPORT</span> <span class="no">OSStartHighRdy</span>
</span></span><span class="line"><span class="cl"><span class="nf">EXPORT</span> <span class="no">OS_CPU_PendSVHandler</span>
</span></span><span class="line"><span class="cl"><span class="nf">AREA</span> <span class="err">|</span><span class="no">.text</span><span class="err">|</span><span class="p">,</span> <span class="no">CODE</span><span class="p">,</span> <span class="no">READONLY</span><span class="p">,</span> <span class="no">ALIGN</span><span class="err">=</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nf">THUMB</span>
</span></span><span class="line"><span class="cl"><span class="nf">REQUIRE8</span>
</span></span><span class="line"><span class="cl"><span class="nf">PRESERVE8</span>
</span></span><span class="line"><span class="cl"><span class="c1">; ä¿å­˜ä¸­æ–­çŠ¶æ€å¹¶å…³ä¸­æ–­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">OS_CPU_SR_Save</span> <span class="no">PROC</span>
</span></span><span class="line"><span class="cl"><span class="nf">MRS</span> <span class="no">R0</span><span class="p">,</span> <span class="no">PRIMASK</span> <span class="c1">; è¯»å–PRIMASK/BASEPRIï¼ˆä¸­æ–­çŠ¶æ€å¯„å­˜å™¨ï¼‰å¹¶å­˜â¼ŠR0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">CPSID</span> <span class="no">I</span> <span class="c1">; å…³é—­ä¸­æ–­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">BX</span> <span class="no">LR</span> <span class="c1">; è¿”å›
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ENDP</span>
</span></span><span class="line"><span class="cl"><span class="c1">; æ¢å¤ä¸­æ–­çŠ¶æ€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">OS_CPU_SR_Restore</span> <span class="no">PROC</span>
</span></span><span class="line"><span class="cl"><span class="nf">MSR</span> <span class="no">PRIMASK</span><span class="p">,</span> <span class="no">R0</span> <span class="c1">; å°†R0çš„å€¼å†™å›PRIMASK/BASEPRIå¯„å­˜å™¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">BX</span> <span class="no">LR</span>
</span></span><span class="line"><span class="cl"><span class="nf">ENDP</span>
</span></span><span class="line"><span class="cl"><span class="c1">; ä»»åŠ¡ä¸Šä¸‹â½‚åˆ‡æ¢ï¼Œæ­¤å¤„ä¸ºç©ºå®ç°ï¼Œä»…ä¾›é€šè¿‡ç¼–è¯‘ã€‚ä»¥åéœ€è¦å®ç°ä»»åŠ¡ä¸Šä¸‹â½‚åˆ‡æ¢ä»£ç ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">OSCtxSw</span> <span class="no">PROC</span>
</span></span><span class="line"><span class="cl"><span class="nf">BX</span> <span class="no">LR</span>
</span></span><span class="line"><span class="cl"><span class="nf">ENDP</span>
</span></span><span class="line"><span class="cl"><span class="c1">; ä¸­æ–­çº§ä»»åŠ¡åˆ‡æ¢ï¼Œç©ºå®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">OSIntCtxSw</span> <span class="no">PROC</span>
</span></span><span class="line"><span class="cl"><span class="nf">BX</span> <span class="no">LR</span>
</span></span><span class="line"><span class="cl"><span class="nf">ENDP</span>
</span></span><span class="line"><span class="cl"><span class="c1">; å¯åŠ¨æœ€â¾¼ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œç©ºå®ç°ï¼Œå®é™…éœ€è¦åˆå§‹åŒ–ä»»åŠ¡å †æ ˆå¹¶å¯åŠ¨ç¬¬â¼€ä¸ªä»»åŠ¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">OSStartHighRdy</span> <span class="no">PROC</span>
</span></span><span class="line"><span class="cl"><span class="nf">BX</span> <span class="no">LR</span>
</span></span><span class="line"><span class="cl"><span class="nf">ENDP</span>
</span></span><span class="line"><span class="cl"><span class="c1">; PendSV ä¸­æ–­å¤„ç†ï¼Œç©ºå®ç°ï¼Œå®é™…åº”å®ç°PendSVä¸­æ–­å¤„ç†ä»¥å®Œæˆä»»åŠ¡åˆ‡æ¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">OS_CPU_PendSVHandler</span> <span class="no">PROC</span>
</span></span><span class="line"><span class="cl"><span class="nf">BX</span> <span class="no">LR</span>
</span></span><span class="line"><span class="cl"><span class="nf">ENDP</span>
</span></span><span class="line"><span class="cl"><span class="nf">END</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é”™è¯¯ç±»å‹8ç¼ºå°‘mainå‡½æ•°">é”™è¯¯ç±»å‹8ï¼šç¼ºå°‘mainå‡½æ•°
</h3><p><strong>è§£å†³æ–¹æ³•ï¼šæ·»åŠ ä¸»å‡½æ•°</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="p">.</span><span class="err">\</span><span class="n">Objects</span><span class="err">\</span><span class="n">test</span><span class="p">.</span><span class="nl">axf</span><span class="p">:</span> <span class="nl">Error</span><span class="p">:</span> <span class="nl">L6218E</span><span class="p">:</span> <span class="n">Undefined</span> <span class="n">symbol</span> <span class="nf">main</span> <span class="p">(</span><span class="n">referred</span> <span class="n">from</span> <span class="n">__rtentry2</span><span class="p">.</span><span class="n">o</span><span class="p">).</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ›å»ºuseræ–‡ä»¶å¤¹ï¼ŒåŠ å…¥main.cæ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;ucos_ii.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="å·¥ç¨‹éªŒè¯">å·¥ç¨‹éªŒè¯
</h1><h3 id="æƒ³æ³•1è°ƒå‡½æ•°">æƒ³æ³•1ï¼šè°ƒâ½¤å‡½æ•°
</h3><p>egï¼šOSTimeDly(1000 * 2);</p>
<p>é¢„æœŸç»“æœï¼šç¼–è¯‘é€šè¿‡ä¸”ä¸æŠ¥é”™ï¼Œè¯´æ˜â¼¯ç¨‹æ­å»ºæˆåŠŸã€‚</p>
<h3 id="æƒ³æ³•2ç‚¹äº®ç¯">æƒ³æ³•2ï¼šç‚¹äº®â¼©ç¯
</h3><p>ç”±äºä»»åŠ¡åˆ›å»ºç‚¹äº®â¼©ç¯éœ€è¦ä¾‹å¦‚åˆ›å»ºtcbï¼Œå †æ ˆâ¼¤â¼©ä¼˜å…ˆçº§ï¼Œé˜Ÿåˆ—ï¼Œå»¶æ—¶ç­‰çŸ¥è¯†ï¼Œåœ¨åç»­çš„å­¦ä¹ ä¸­æˆ‘ä»¬æ‰ä¼šå­¦åˆ°ã€‚ä½†æˆ‘ä»¬ä»æƒ³é€šè¿‡ç‚¹äº®â¼©ç¯æ¥éªŒè¯â¼¯ç¨‹æ­å»ºæˆåŠŸã€‚</p>
<p>å› æ­¤æˆ‘ä»¬çš„æ€è·¯æ˜¯ï¼š</p>
<p>å†™â¼€ä¸ªled.cï¼Œé€šè¿‡ä¸Šâ¾¯æˆ‘ä»¬æåˆ°çš„é’©â¼¦å‡½æ•°è°ƒâ½¤led.cï¼Œå†åœ¨main.câ¾¥â¾¯è°ƒâ½¤é’©â¼¦å‡½æ•°ï¼Œä»â½½è¾¾åˆ°é€šè¿‡ç‚¹äº®â¼©ç¯éªŒè¯â¼¯ç¨‹æ­å»ºæ˜¯å¦æˆåŠŸã€‚ç”±äºæ—¶é—´å…³ç³»ï¼Œæˆ‘ä»¬ç›´æ¥æ¥çœ‹æˆ‘ä»¬å†™å¥½çš„ç‚¹ç¯ç¨‹åºã€‚</p>
<p>è¿™â¾¥æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬éœ€è¦æ³¨é‡Šæ‰æˆ‘ä»¬â¾ƒâ¼°åœ¨cpu_c.hä¸­å†™çš„ç©ºçš„SystemIntï¼ˆï¼‰å‡½æ•°ï¼Œå› ä¸ºåœ¨</p>
<p>f401å·²ç»å«æœ‰åˆå§‹åŒ–ç³»ç»Ÿçš„å‡½æ•°ã€‚</p>
<p>é¢„æœŸç»“æœï¼šç¼–è¯‘é€šè¿‡ä¸”ä¸æŠ¥é”™ï¼Œæ¿è½½â¼©ç¯L2é—ªçƒï¼Œè¯´æ˜â¼¯ç¨‹æ­å»ºæˆåŠŸã€‚</p>
<h1 id="é¡¹ç›®æ€»ç»“">é¡¹ç›®æ€»ç»“
</h1><p>é€šè¿‡æœ¬é¡¹ç›®ï¼ŒæŒæ¡äº†Î¼C/OS-IIå†…æ ¸é‡æ„çš„æ ¸å¿ƒæµç¨‹ï¼Œè§£å†³äº†è·¨å¹³å°ç§»æ¤ä¸­çš„å…¸å‹é—®é¢˜ï¼Œä¸ºåç»­å®ç°å®Œæ•´RTOSåŠŸèƒ½æ‰“ä¸‹åšå®åŸºç¡€ã€‚ä¸‹ä¸€æ­¥å°†æ·±å…¥ä»»åŠ¡è°ƒåº¦ä¸ç¡¬ä»¶é©±åŠ¨é›†æˆï¼Œæ„å»ºå®æ—¶åµŒå…¥å¼åº”ç”¨ã€‚</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 KiWiT
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
